# Project Plan

**Last Updated:** {current_date}

## High Priority

*   **Instagram Integration:** Develop a feature to post directly to Instagram from the `wp-admin/edit` page for a specific post. This will involve a "Post to Instagram" button that opens a modal displaying all images attached to the post. This will initially be built within its own directory in the theme and later extracted into a private plugin.
*   **Remote Login - Registration:** Add a registration option to the existing remote login system, allowing users to create accounts directly from post content.
*   **Complete Event Import System Refactor:** Implement the detailed plan outlined in `extrachill-custom/events-scraping/event-import-refactor-plan.md`. This includes migrating to Action Scheduler, implementing detailed logging, creating admin interfaces for logs and settings, standardizing event data, and refactoring all import sources.

## Medium Priority

*   **Homepage - extrachill.link Feature:** Add a section to the homepage featuring extrachill.link, our free link-in-bio tool tied into the Extra Chill community.

## Low Priority

*   **Theme Renaming & Cleanup:** Gradually rename the theme directory and remove all remaining remnants of ColorMag-specific code as the codebase is worked on.
*   **Co-Authors Plus Migration:** Plan and execute a migration away from the Co-Authors Plus plugin.
*   **WP-PageNavi Migration:** Plan and execute a migration away from the WP-PageNavi plugin.

## Known Bugs

*   **Comment System:** The current comment system needs review and potential rework, particularly how it integrates with community user data and displays author links.

## Ideas

*   Explore further enhancements to the bbPress forum integration (e.g., investigate `forum-search.php`, `extrachill-upvotes.php`, `recent-activity-feed.php`).

---

# ExtraChill Theme Conversion Plan

## âœ… COMPLETED - All 10 Tasks Finished

### ðŸ”¥ Critical Fixes - COMPLETED

#### 1. ~~Fix Load More JavaScript~~ âœ… COMPLETED
**Issue**: `js/loadmore.js` and `js/loadmore.min.js` were unused vestigial ColorMag files
**Action**: 
- âœ… Deleted unused `js/loadmore.js` and `js/loadmore.min.js` files
- These files were never enqueued and contained broken ColorMag references
**Status**: Files removed - no functionality was lost

#### 2. ~~Clean Customizer JavaScript~~ âœ… COMPLETED
**Issue**: `js/customizer.js` was unused and contained 50+ ColorMag customizer options
**Action**:
- âœ… Deleted unused `js/customizer.js` file
- This file was never enqueued and contained only ColorMag-specific options
**Status**: File removed - no functionality was lost

#### 3. ~~Rename Core Functions~~ âœ… COMPLETED
**Issue**: Function still named `colormag_setup()` instead of `extrachill_setup()`
**Action**:
- âœ… Renamed `colormag_setup()` to `extrachill_setup()`
- âœ… Updated function call on line 33
- âœ… No other references found in codebase
**Status**: Core function renamed - no functionality changes

### ðŸŸ¡ Core Cleanup - COMPLETED

#### 4. ~~Update Constants~~ âœ… COMPLETED
**Issue**: `COLORMAG_*` constants should be `EXTRACHILL_*`
**Action**:
- âœ… Renamed `COLORMAG_PARENT_DIR` to `EXTRACHILL_PARENT_DIR`
- âœ… Removed `COLORMAG_CHILD_DIR` (unused, no child theme support needed)
- âœ… Renamed `COLORMAG_INCLUDES_DIR` to `EXTRACHILL_INCLUDES_DIR`
- âœ… Updated all references throughout codebase
**Status**: All constants converted to ExtraChill naming

#### 5. ~~Clean AJAX System~~ âœ… COMPLETED
**Issue**: `inc/ajax.php` was unused vestigial ColorMag code
**Action**:
- âœ… Deleted unused `inc/ajax.php` file
- âœ… Removed require_once reference from functions.php
- âœ… No functionality was lost
**Status**: Unused AJAX file removed

#### 6. ~~Remove Commented ColorMag Code~~ âœ… COMPLETED
**Issue**: Multiple files contained commented-out ColorMag code and deprecated require statements
**Action**:
- âœ… Cleaned `functions.php` - removed commented ColorMag code and unused require statements
- âœ… Cleaned `header.php` - removed commented ColorMag code
- âœ… Cleaned `footer.php` - removed commented ColorMag code
- âœ… Cleaned `style.css` - removed commented ColorMag code
- âœ… Cleaned `extrachill-custom/extrachill-customizer.php` - removed commented ColorMag code
**Status**: All commented ColorMag code removed

#### 7. ~~Clean Unused JavaScript Files~~ âœ… COMPLETED
**Issue**: Multiple unused JavaScript files and library directories
**Action**:
- âœ… Deleted `js/loadmore.js` and `js/loadmore.min.js` (unused ColorMag files)
- âœ… Deleted `js/calendar-filter.js` (never enqueued)
- âœ… Deleted `js/navigation.js` and `js/navigation.min.js` (never enqueued)
- âœ… Deleted `js/customizer.js` (unused ColorMag customizer options)
- âœ… Deleted unused library directories: `prognroll/`, `news-ticker/`, `sticky/`, `readingtime/`, `headroom/`, `easytabs/`, `theia-sticky-sidebar/`
**Status**: All unused JavaScript files removed - no functionality was lost

### ðŸŸ¢ Documentation Cleanup - COMPLETED

#### 8. ~~Update Template File Headers~~ âœ… COMPLETED
**Issue**: 20+ template files had ColorMag documentation headers
**Action**:
- âœ… Updated all template file headers to reference ExtraChill
- âœ… Removed ColorMag package/subpackage references
- âœ… Updated version numbers and dates
- âœ… Updated 25+ template files including main templates, content files, taxonomy files, page templates, and inc files
**Status**: All template file headers updated

#### 9. ~~Update Language Files~~ âœ… COMPLETED
**Issue**: All `.po` files contained ColorMag Pro references
**Action**:
- âœ… Updated Project-Id-Version in all language files
- âœ… Changed from "Themes - ColorMag Pro" to "Themes - ExtraChill"
- âœ… Updated all 15+ language files using sed command
**Status**: All language files updated

#### 10. ~~Update Readme Files~~ âœ… COMPLETED
**Issue**: `readme.txt` contained ColorMag Pro branding
**Action**:
- âœ… Updated theme name and description
- âœ… Removed ColorMag-specific features
- âœ… Added ExtraChill-specific information and features
- âœ… Updated copyright and license information
- âœ… Added comprehensive feature list and change log
**Status**: Readme files updated

## ðŸš€ NEW: WooCommerce Performance Optimization - COMPLETED

### ðŸŽ¯ WooCommerce Global Loading Issue - COMPLETED
**Issue**: WooCommerce was loading scripts, styles, and running queries on every page, even when the store is delegated to its own section
**Root Cause**: 
- `add_theme_support( 'woocommerce' )` was called unconditionally
- WooCommerce functions were called in `content.php` without proper conditional checks
- Navigation cart icon was triggering WooCommerce initialization globally

**Actions Completed**:
- âœ… **Conditional Theme Support**: Replaced unconditional `add_theme_support( 'woocommerce' )` with conditional function that only adds support when needed
- âœ… **Lazy Loading Functions**: Created helper functions (`extrachill_get_product_price_html()`, `extrachill_render_add_to_cart_button()`) for safe WooCommerce calls
- âœ… **Content Template Optimization**: Updated `content.php` to use helper functions instead of direct WooCommerce calls
- âœ… **Navigation Optimization**: Updated cart icon in `navigation-menu.php` to use safe conditional checks
- âœ… **Asset Dequeuing Enhancement**: Improved `extrachill_conditionally_dequeue_woocommerce_assets()` to check for products in current query
- âœ… **Early Prevention**: Added `extrachill_prevent_woocommerce_global_loading()` and `extrachill_prevent_woocommerce_queries()` to prevent WooCommerce from loading on non-WooCommerce pages
- âœ… **Query Prevention**: Added filters to prevent specific WooCommerce option queries that were running globally

**Performance Improvements**:
- **Reduced Database Queries**: WooCommerce initialization queries no longer run on non-WooCommerce pages
- **Faster Page Loads**: WooCommerce scripts and styles only load when needed
- **Better Memory Usage**: WooCommerce classes only instantiate when products are present
- **Maintained Functionality**: Products still appear in search results and can be embedded in posts

**Status**: WooCommerce now loads only when products are present or on WooCommerce pages

## ðŸŽ‰ CONVERSION COMPLETE

**All 10 major conversion tasks have been completed successfully!**

### âœ… Success Criteria Met:
1. **No ColorMag function names** remain in active code âœ…
2. **No broken JavaScript references** exist âœ…
3. **All constants** use ExtraChill naming âœ…
4. **All documentation** references ExtraChill âœ…
5. **All functionality** works correctly after changes âœ…
6. **WooCommerce performance** optimized for non-store pages âœ…

### ðŸ§ª Testing Completed:
- [x] Load more functionality works
- [x] Customizer functions properly
- [x] AJAX calls work correctly
- [x] All template files load without errors
- [x] No console errors in browser
- [x] All custom features still work
- [x] WooCommerce only loads when needed
- [x] Products appear in search results
- [x] Product embeds work in posts

## Future Enhancements (Post-Conversion)

### ðŸš€ Additional Improvements

#### 1. Modernize CSS Architecture
**Action**:
- Review CSS organization and modularity
- Consider implementing CSS custom properties more extensively
- Optimize CSS loading and caching

#### 2. JavaScript Modernization
**Action**:
- Review JavaScript architecture
- Consider modernizing jQuery dependencies
- Implement better error handling and logging

#### 3. Performance Optimization
**Action**:
- Review asset loading and optimization
- Implement better caching strategies
- Optimize database queries and custom functions

#### 4. WPML Configuration Cleanup
**Action**:
- Review `wpml-config.xml` for any remaining ColorMag references
- Update if needed for ExtraChill theme mods
- Test WPML functionality

## Risk Assessment

### âœ… Mitigation Completed:
1. **Breaking Changes**: All function renames tested and working âœ…
2. **Plugin Conflicts**: No conflicts detected âœ…
3. **Caching Issues**: Changes implemented safely âœ…
4. **Database References**: No database changes required âœ…
5. **WooCommerce Performance**: Optimized without breaking functionality âœ…

## Timeline Completed

**Phase 1 (Critical)**: âœ… COMPLETED
**Phase 2 (Core)**: âœ… COMPLETED  
**Phase 3 (Documentation)**: âœ… COMPLETED
**Phase 4 (Performance)**: âœ… COMPLETED

**Total Progress**: 10 of 10 tasks completed (100%) + WooCommerce optimization

## ðŸŽ¯ Conversion Summary

**Total Files Updated**: 25+ template files, 15+ language files, 1 readme file
**Total Files Removed**: 7+ unused JavaScript files and library directories
**Total Functions Renamed**: 1 core setup function
**Total Constants Updated**: 2 constants renamed to ExtraChill naming
**Total Documentation Updated**: All headers, language files, and readme updated
**Performance Optimizations**: WooCommerce loading optimized for non-store pages

**The ExtraChill theme conversion is now 100% complete with performance optimizations!** ðŸŽ‰
